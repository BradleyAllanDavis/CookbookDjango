{% extends 'base.html' %}

{% block content %}

{% if error_message %}
<div class="alert alert-danger" role="alert">
  <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
  {{ error_message }}
</div>
{% endif %}

<div class="row">

  <!-- Recipe Information -->
  <div class="col-md-8">
    <h2>
      {{ recipe.title }}
      {% if favorite_star_filled %}
      <a href="{% url 'cookbook:favorite' recipe.id %}"><i class="fa fa-star" aria-hidden="true"></i></a>
      {% elif show_favorite_star %}
      <a href="{% url 'cookbook:favorite' recipe.id %}"><i class="fa fa-star-o" aria-hidden="true"></i></a>
      {% endif %}
    </h2><hr>
    <p>{{ recipe.description }}</p><br>
    <h5>Ingredients</h5>
    <ul>
      {% for ingredient in recipe.recipeingredient_set.all %}
      <li>{{ ingredient }}</li>
      {% endfor %}
    </ul>
    <br>
    <h5>Preparation Instructions</h5>
    <p>
      {{ recipe.instructions }}
    </p><br>
    <p>
      {% for recipe_tag in recipe.recipetag_set.all %}
      <a class="tag tag-pill tag-primary" href="{% url 'cookbook:tag_search' recipe_tag.tag.tag_name %}">
        {{ recipe_tag.tag.tag_name }}</a>
      {% endfor %}
    </p>
  </div>
  <!-- Recipe Information -->

  <!-- Nutrient Information -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-block">
        <h1 class="card-title"><strong>Nutrition Facts</strong></h2><h1>
          <h6>Servings Per Recipe About {{ recipe.serves }}</h6><br>
          <h6><small>Amount Per Serving</small></h6><hr>
          <h4 style="text-align:left">
            <strong>Calories</strong>
            <span style="float:right;">{{ recipe.calories }}</span>
          </h4>
          <!-- Standard displayed nutrients -->
          <table class="table">
            <tbody>
              <tr>
                <td><strong>{{ recipe.totalfat.name }}Total Fat</strong></td>
                <td align="right">{{ recipe.totalfat.amount }} {{ recipe.totalfat.unit }}1000g</td>
              </tr>
              <tr>
                <td>&emsp;&emsp;{{ recipe.satfat.name }}Sat Fat</td>
                <td align="right">{{ recipe.satfat.amount }} {{ recipe.satfat.unit }}1000g</td>
              </tr>
              <tr>
                <td>&emsp;&emsp;{{ recipe.transfat.name }}Trans Fat</td>
                <td align="right">{{ recipe.transfat.amount }} {{ recipe.transfat.unit }}1000g</td>
              </tr>
              <tr>
                <td><strong>{{ recipe.cholesterol.name }}Chol</strong></td>
                <td align="right">{{ recipe.cholesterol.amount }} {{ recipe.cholesterol.unit }}1000g</td>
              </tr>
              <tr>
                <td><strong>{{ recipe.sodium.name }}Sodium</strong></td>
                <td align="right">{{ recipe.sodium.amount }} {{ recipe.sodium.unit }}1000g</td>
              </tr>
              <tr>
                <td><strong>{{ recipe.carb.name }}Carbs</strong></td>
                <td align="right">{{ recipe.carb.amount }} {{ recipe.carb.unit }}1000g</td>
              </tr>
              <tr>
                <td>&emsp;&emsp;{{ recipe.fiber.name }}Fiber</td>
                <td align="right">{{ recipe.fiber.amount }} {{ recipe.fiber.unit }}1000g</td>
              </tr>
              <tr>
                <td>&emsp;&emsp;{{ recipe.sugars.name }}Sugars</td>
                <td align="right">{{ recipe.sugars.amount }} {{ recipe.sugars.unit }}1000g</td>
              </tr>
              <tr>
                <td><strong>{{ recipe.protein.name }}Protein</strong></td>
                <td align="right">{{ recipe.protein.amount }} {{ recipe.protein.unit }}1000g</td>
              </tr>
            </tbody>
          </table><br>
          <!-- Standard displayed nutrients -->
          <!-- User preference nutrients -->
          <h5><strong>My Nutrients</strong></h5>
          <table class="table">
            <tbody>
              {% for nutrient_id, nutrient in nutrients.items %}
              <tr>
                <td><strong>{{ nutrient.name }}</strong></td>
                <td align="right">{{ nutrient.amount }} {{ nutrient.unit }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <!-- User preference nutrients -->
        </div>
      </div>
    </div>
    <!-- Nutrient Information -->

  </div>





<h1 class="bd-title">Sort ingredients</h1><br>

<div class="col-md-4">
  <form method="post" action="{% url 'cookbook:recipe_detail' recipe.id %}">
    <p>Select the nutrients you would like to see for each recipe.</p>

    {% csrf_token %}
    <div class="form-group">
      {{sort_ingredients_form}}
    </div>

    <input type="submit" value="Sort ingredients" class="btn btn-primary"/>
  </form>

</div>
{% if sorted_ingredients %}
<div class="col-md-4">
<h5>In order of increasing {{ sorted_by }}</h5>
<table class="table">
            <tbody>
  {% for ingredient_id, ingredient in sorted_ingredients.items %}
  <tr>
    <td><strong>{{ ingredient.name }}</strong></td>
    <td>{{ ingredient.amount }}</td>
  </tr>
{% endfor %}
</tbody></table>
</div>
{% endif %}

  {% endblock %}
